import{aB as E,f as M,aC as y,O as A,k as R,aD as _,m as L,aE as k,aF as D}from"./CrswDLC_.js";function I(){const s=E(),{t}=M(),o=(r,c,l,d=1e3)=>{s.add({severity:r,summary:c,detail:l,life:d})};return{toast:s,showErrorToast:r=>{o("error",t("toast.error"),r)},showSuccessToast:r=>{o("success",t("toast.success"),r)},showInfoToast:r=>{o("info",t("toast.info"),r)},showWarnToast:r=>{o("warn",t("toast.warn"),r)}}}const W=(s,t={})=>{const o=y()?.userData?.token||JSON.parse(window.sessionStorage.getItem("authStore"))?.token,n=A().lang,a=R(),w=t.baseURL||a.public.apiBase,g={...s?{authorization:`Bearer ${o}`}:{},"accept-language":n||"en",...t.headers};return{baseURL:w,headers:g,response_type:"json",...t}},$=async(s,t,o={},n)=>{try{return{data:await $fetch(s,{...W(t,o),method:n,body:o.body||void 0}),error:null}}catch(a){return console.error(`Error fetching data from ${s}:`,a),{data:null,error:a}}},v=(s,t,o={})=>$(s,t,o,"GET"),O=(s,t,o,n="POST",a={})=>$(s,t,{...a,body:o},n);function B(){const s=A(),t=y(),o=k(),n=_(),{showErrorToast:a,showSuccessToast:w,showInfoToast:g,showWarnToast:r}=I(),c=async e=>{setTimeout(()=>{e=="reload_page"?o.go(0):e=="unAuthed"?(D("authStore").value=null,o.push(n("/login"))):o.push(n(e))},500)},l=(e,u)=>{s.switchLoading(!1),e=="success"?w(u):e=="info"?g(u):e=="warn"?r(u):a(u)},d=L(null),S=async(e,u,T,p)=>{s.switchLoading(!0),d.value=null;const{data:i,error:h}=await v(`${e}${u?`${e.includes("?")?"&":"?"}page=${u}`:""}`,T);h?(l("error",h?.response?._data?.message),h?.response?._data?.error==="Unauthorized"&&c("unAuthed")):(i.status=="success"&&(d.value=i),s.switchLoading(!1),p&&l(i?.status,i?.message))},b=L(null);return{getMethod:S,getResult:d,submitMethod:async(e,u,T,p,i,h)=>{s.switchLoading(!0);const{data:f,error:m}=await O(e,u,T,p);m?(l("error",m?.response?._data?.message),m?.response?._data?.error==="Unauthorized"&&c("unAuthed")):(e.endsWith("logout")&&c("unAuthed"),i&&c(i),h&&S(h,"",!!t,!1),e.endsWith("login")&&f&&t?.handleUserData(f?.data),b.value=f,l(f?.status,f?.message),s.switchLoading(!1))},submitResult:b,showErrorToast:a,handleNextRoute:c}}export{I as a,B as u};
