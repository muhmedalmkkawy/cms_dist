import{aB as E,f as M,O as L,aC as A,k as R,aD as _,m as y,aE as W,aF as k}from"./B8ziTJHJ.js";function v(){const s=E(),{t}=M(),o=(a,r,l,f=1e3)=>{s.add({severity:a,summary:r,detail:l,life:f})};return{toast:s,showErrorToast:a=>{o("error",t("toast.error"),a)},showSuccessToast:a=>{o("success",t("toast.success"),a)},showInfoToast:a=>{o("info",t("toast.info"),a)},showWarnToast:a=>{o("warn",t("toast.warn"),a)}}}const D=(s,t={})=>{const o=L(),n=A()?.user?.token,g=o?.lang,w=R(),a=t.baseURL||w.public.apiBase,r={...s?{authorization:`Bearer ${n}`}:{},"accept-language":g||"en","content-type":"application/json",...t.headers};return{baseURL:a,headers:r,response_type:"json",...t}},$=async(s,t,o={},u)=>{try{return{data:await $fetch(s,{...D(t,o),method:u,body:o.body||void 0}),error:null}}catch(n){return console.error(`Error fetching data from ${s}:`,n),{data:null,error:n}}},I=(s,t,o={})=>$(s,t,o,"GET"),U=(s,t,o,u="POST",n={})=>$(s,t,{...n,body:o},u);function C(){const s=L(),t=A(),o=W(),u=_(),{showErrorToast:n,showSuccessToast:g,showInfoToast:w,showWarnToast:a}=v(),r=async e=>{setTimeout(()=>{e=="reload_page"?o.go(0):e=="unAuthed"?(k("authStore").value=null,o.push(u("/login"))):o.push(u(e))},500)},l=(e,c)=>{s.switchLoading(!1),e=="success"?g(c):e=="info"?w(c):e=="warn"?a(c):n(c)},f=y(null),S=async(e,c,T,p)=>{s.switchLoading(!0),f.value=null;const{data:i,error:h}=await I(`${e}${c?`${e.includes("?")?"&":"?"}page=${c}`:""}`,T);h?(l("error",h?.response?._data?.message),h?.response?._data?.error==="Unauthorized"&&r("unAuthed")):(i.status=="success"&&(f.value=i),s.switchLoading(!1),p&&l(i?.status,i?.message))},m=y(null);return{getMethod:S,getResult:f,submitMethod:async(e,c,T,p,i,h)=>{s.switchLoading(!0);const{data:d,error:b}=await U(e,c,T,p);b?(l("error",b?.response?._data?.message),b?.response?._data?.error==="Unauthorized"&&r("unAuthed")):(e.endsWith("login")&&d?(t?.handleUserData(d?.data),console.log(d?.data)):e.endsWith("logout")&&r("unAuthed"),i&&r(i),h&&S(h,"",!!t,!1),m.value=d,l(d?.status,d?.message),s.switchLoading(!1))},submitResult:m,showErrorToast:n,handleNextRoute:r}}export{v as a,C as u};
