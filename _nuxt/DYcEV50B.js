import{aB as E,f as M,O as y,aC as A,k as R,aD as _,m as L,aE as W,aF as k}from"./EmtnkoT-.js";function v(){const s=E(),{t}=M(),o=(a,n,l,f=1e3)=>{s.add({severity:a,summary:n,detail:l,life:f})};return{toast:s,showErrorToast:a=>{o("error",t("toast.error"),a)},showSuccessToast:a=>{o("success",t("toast.success"),a)},showInfoToast:a=>{o("info",t("toast.info"),a)},showWarnToast:a=>{o("warn",t("toast.warn"),a)}}}const D=(s,t={})=>{const o=y(),r=A()?.user?.token,g=o?.lang,w=R(),a=t.baseURL||w.public.apiBase,n={...s?{authorization:`Bearer ${r}`}:{},"accept-language":g||"en",...t.headers};return{baseURL:a,headers:n,response_type:"json",...t}},$=async(s,t,o={},c)=>{try{return{data:await $fetch(s,{...D(t,o),method:c,body:o.body||void 0}),error:null}}catch(r){return console.error(`Error fetching data from ${s}:`,r),{data:null,error:r}}},I=(s,t,o={})=>$(s,t,o,"GET"),U=(s,t,o,c="POST",r={})=>$(s,t,{...r,body:o},c);function C(){const s=y(),t=A(),o=W(),c=_(),{showErrorToast:r,showSuccessToast:g,showInfoToast:w,showWarnToast:a}=v(),n=async e=>{setTimeout(()=>{e=="reload_page"?o.go(0):e=="unAuthed"?(k("authStore").value=null,o.push(c("/login"))):o.push(c(e))},500)},l=(e,u)=>{s.switchLoading(!1),e=="success"?g(u):e=="info"?w(u):e=="warn"?a(u):r(u)},f=L(null),S=async(e,u,T,p)=>{s.switchLoading(!0),f.value=null;const{data:i,error:h}=await I(`${e}${u?`${e.includes("?")?"&":"?"}page=${u}`:""}`,T);h?(l("error",h?.response?._data?.message),h?.response?._data?.error==="Unauthorized"&&n("unAuthed")):(i.status=="success"&&(f.value=i),s.switchLoading(!1),p&&l(i?.status,i?.message))},m=L(null);return{getMethod:S,getResult:f,submitMethod:async(e,u,T,p,i,h)=>{s.switchLoading(!0);const{data:d,error:b}=await U(e,u,T,p);b?(l("error",b?.response?._data?.message),b?.response?._data?.error==="Unauthorized"&&n("unAuthed")):(e.endsWith("login")&&d?(t?.handleUserData(d?.data),console.log(d?.data)):e.endsWith("logout")&&n("unAuthed"),i&&n(i),h&&S(h,"",!!t,!1),m.value=d,l(d?.status,d?.message),s.switchLoading(!1))},submitResult:m,showErrorToast:r,handleNextRoute:n}}export{v as a,C as u};
